:root{ --bg:#0b1020; --fg:#eaf2ff; --muted:#97a9cf; --card:#0f1630; --border:#2a375f; --accent:#79a8ff; --ok:#55d38a; --warn:#ffb454; --bad:#ff6b6b; }
*{ box-sizing:border-box } body{ margin:0; font:14px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif; background:var(--bg); color:var(--fg) }
.wrap{ max-width:1100px; margin:32px auto; padding:0 16px } h1{ font-size:22px; margin:0 0 16px }
.card{ background:var(--card); border:1px solid var(--border); border-radius:16px; padding:16px; margin-bottom:16px }
.card-head{ display:flex; align-items:center; justify-content:space-between; margin-bottom:8px }
.table-wrap{ overflow:auto; border:1px solid var(--border); border-radius:12px } table.fancy{ width:100%; border-collapse:separate; border-spacing:0 }
table.fancy thead th{ position:sticky; top:0; background:#12204a; color:#eaf2ff; font-weight:700; text-align:left; padding:10px; border-bottom:1px solid var(--border); z-index:1 }
table.fancy tbody td{ padding:10px; border-bottom:1px solid var(--border); text-align:left } table.fancy tbody tr:nth-child(odd){ background:rgba(255,255,255,.02) }
.badge{ background:#18234b; border:1px solid #2a375f; padding:6px 10px; border-radius:999px; font-size:12px; cursor:pointer; user-select:none }

/* Flow (classic layout) */
.flowwrap{ position:relative; border:1px solid var(--border); border-radius:12px; background:#0e1838; padding:16px; }
.flow{ position:relative; height:260px }
.flow svg{ position:absolute; inset:0; width:100%; height:100%; z-index:1 }
.node{ position:absolute; background:#101b3d; border:1px solid var(--border); border-radius:12px; padding:8px 10px; min-width:120px; text-align:center; z-index:2 }
.node h3{ margin:0; font-size:14px }
.node .sub{ color:#cfe1ff; font-size:12px }
#n_pv{ left:18px; top:24px }
#n_house{ right:18px; top:24px }
#n_grid{ right:18px; bottom:24px }
#n_batt{ left:18px; bottom:24px; display:flex; gap:10px; align-items:center }

/* Battery icon */
.bat{ width:50px; height:26px; border:2px solid #7a8cc0; border-radius:4px; position:relative; }
.bat::after{ content:''; position:absolute; right:-6px; top:7px; width:6px; height:12px; background:#7a8cc0; border-radius:1px }
.bat .fill{ position:absolute; left:0; top:0; bottom:0; width:0%; background:var(--ok) }
.bat.low .fill{ background:var(--bad) } .bat.mid .fill{ background:var(--warn) }

/* Labels above lines */
.flow-label{ position:absolute; padding:2px 8px; background:rgba(15,22,48,.96); border:1px solid var(--border); border-radius:999px; font-weight:700; font-size:12px; z-index:3; pointer-events:none }
.hidden{ display:none }

/* Animated tokens */
.token.pv{ fill:#6be29f } .token.batt{ fill:#ffd480 }
.token.grid{ fill:#87a6ff } /* not used, but reserved */
.token{ filter: drop-shadow(0 0 2px rgba(255,255,255,.25)); }

/* Condensed KPI layout (3 boxes) */
.kpi3{ display:grid; grid-template-columns: repeat(3,minmax(0,1fr)); gap:10px }
.box{ background:#0e1838; border:1px solid var(--border); border-radius:12px; padding:10px }
.box .label{ color:#cfe1ff; font-size:12px; margin-bottom:4px }
.box .val{ font-size:18px; font-weight:700 }
.box .lines{ display:grid; gap:4px; font-size:14px }
.box .lines .row{ display:flex; justify-content:space-between; gap:8px }
@media (max-width: 860px){ .kpi3{ grid-template-columns: 1fr; } }
